<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>

<?import javafx.scene.control.cell.PropertyValueFactory?>
<AnchorPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.example.Shoyeb_2311303.ManageInventoryLevelsController"
            prefHeight="700.0" prefWidth="1000.0"
            style="-fx-background-color: #f0f2f5;">

    <!-- Header Section -->
    <VBox AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0"
          style="-fx-background-color: #2c3e50; -fx-padding: 15;">
        <HBox alignment="CENTER_LEFT" spacing="10">
            <Label text="ðŸ“¦ Inventory Management System"
                   style="-fx-text-fill: white; -fx-font-size: 24px; -fx-font-weight: bold;" />
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="userLabel" text="User: Admin (Shoyeb_2311303)"
                   style="-fx-text-fill: #ecf0f1; -fx-font-size: 14px;" />
        </HBox>
        <Label text="Manage Inventory Levels"
               style="-fx-text-fill: #bdc3c7; -fx-font-size: 16px; -fx-padding: 5 0 0 0;" />
    </VBox>

    <!-- Main Content Area -->
    <VBox AnchorPane.topAnchor="80" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20" AnchorPane.bottomAnchor="20"
          spacing="15">

        <!-- Dashboard Tabs -->
        <TabPane fx:id="dashboardTabPane" tabClosingPolicy="UNAVAILABLE"
                 VBox.vgrow="ALWAYS">

            <!-- Tab 1: Raw Materials -->
            <Tab text="Raw Materials">
                <BorderPane>
                    <top>
                        <HBox spacing="10" style="-fx-padding: 15;">
                            <Label text="Raw Materials Inventory"
                                   style="-fx-font-size: 18px; -fx-font-weight: bold;" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Button text="ðŸ”„ Refresh" fx:id="refreshRawBtn"
                                    onAction="#handleRefreshRawMaterials" />
                        </HBox>
                    </top>
                    <center>
                        <TableView fx:id="rawMaterialsTable" BorderPane.alignment="CENTER">
                            <columns>
                                <TableColumn text="ID" prefWidth="80">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="id" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Name" prefWidth="150">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="name" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Quantity" prefWidth="100">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="quantity" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Unit" prefWidth="80">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="unit" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Reorder Level" prefWidth="110">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="reorderLevel" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Location" prefWidth="120">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="location" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Status" prefWidth="100">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="status" />
                                    </cellValueFactory>
                                </TableColumn>
                            </columns>
                        </TableView>
                    </center>
                </BorderPane>
            </Tab>

            <!-- Tab 2: In-Stock -->
            <Tab text="In-Stock">
                <BorderPane>
                    <top>
                        <HBox spacing="10" style="-fx-padding: 15;">
                            <Label text="In-Stock Products"
                                   style="-fx-font-size: 18px; -fx-font-weight: bold;" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Button text="ðŸ”„ Refresh" fx:id="refreshInStockBtn"
                                    onAction="#handleRefreshInStock" />
                        </HBox>
                    </top>
                    <center>
                        <TableView fx:id="inStockTable" BorderPane.alignment="CENTER">
                            <columns>
                                <TableColumn text="Product ID" prefWidth="100">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="productId" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Product Name" prefWidth="180">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="productName" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Quantity" prefWidth="100">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="quantity" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Category" prefWidth="120">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="category" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Last Updated" prefWidth="150">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="lastUpdated" />
                                    </cellValueFactory>
                                </TableColumn>
                            </columns>
                        </TableView>
                    </center>
                </BorderPane>
            </Tab>

            <!-- Tab 3: Low Stock -->
            <Tab text="Low Stock">
                <BorderPane>
                    <top>
                        <VBox spacing="10" style="-fx-padding: 15;">
                            <HBox>
                                <Label text="âš  Low Stock Alert Dashboard"
                                       style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #e74c3c;" />
                                <Region HBox.hgrow="ALWAYS" />
                                <Button text="ðŸ”„ Refresh" fx:id="refreshLowBtn"
                                        onAction="#handleRefreshLowStock" />
                            </HBox>
                            <HBox spacing="20">
                                <Label fx:id="alertCountLabel" text="Alerts: 0"
                                       style="-fx-font-size: 14px; -fx-text-fill: #c0392b; -fx-font-weight: bold;" />
                                <Label fx:id="criticalLabel" text="Critical: 0"
                                       style="-fx-font-size: 14px; -fx-text-fill: #e74c3c;" />
                                <Label fx:id="warningLabel" text="Warning: 0"
                                       style="-fx-font-size: 14px; -fx-text-fill: #f39c12;" />
                            </HBox>
                        </VBox>
                    </top>
                    <center>
                        <TableView fx:id="lowStockTable" BorderPane.alignment="CENTER">
                            <columns>
                                <TableColumn text="Item Name" prefWidth="200">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="itemName" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Current" prefWidth="100">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="currentStock" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Reorder At" prefWidth="100">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="reorderLevel" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Status" prefWidth="120">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="status" />
                                    </cellValueFactory>
                                </TableColumn>
                                <TableColumn text="Action Needed" prefWidth="150">
                                    <cellValueFactory>
                                        <PropertyValueFactory property="actionNeeded" />
                                    </cellValueFactory>
                                </TableColumn>
                            </columns>
                        </TableView>
                    </center>
                    <bottom>
                        <HBox spacing="10" alignment="CENTER_RIGHT" style="-fx-padding: 15;">
                            <Button text="ðŸ“§ Notify Procurement" fx:id="notifyBtn"
                                    onAction="#handleNotifyProcurement"
                                    style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold;" />
                        </HBox>
                    </bottom>
                </BorderPane>
            </Tab>
        </TabPane>

        <!-- Update Panel -->
        <VBox spacing="10"
              style="-fx-padding: 20; -fx-background-color: white; -fx-border-color: #ddd; -fx-border-radius: 5;">
            <Label text="Update Inventory Item"
                   style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;" />

            <GridPane hgap="15" vgap="15">
                <columnConstraints>
                    <ColumnConstraints prefWidth="150" />
                    <ColumnConstraints prefWidth="250" />
                    <ColumnConstraints prefWidth="150" />
                    <ColumnConstraints prefWidth="250" />
                </columnConstraints>

                <!-- Row 1 -->
                <Label text="Select Item:" GridPane.rowIndex="0" GridPane.columnIndex="0"
                       style="-fx-font-weight: bold;" />
                <ComboBox fx:id="itemComboBox" promptText="-- Select Item --"
                          prefWidth="250" GridPane.rowIndex="0" GridPane.columnIndex="1" />

                <Label text="New Quantity:" GridPane.rowIndex="0" GridPane.columnIndex="2"
                       style="-fx-font-weight: bold;" />
                <TextField fx:id="quantityField" promptText="Enter quantity"
                           prefWidth="250" GridPane.rowIndex="0" GridPane.columnIndex="3" />

                <!-- Row 2 -->
                <Label text="Reorder Level:" GridPane.rowIndex="1" GridPane.columnIndex="0"
                       style="-fx-font-weight: bold;" />
                <TextField fx:id="reorderField" promptText="Enter reorder level"
                           prefWidth="250" GridPane.rowIndex="1" GridPane.columnIndex="1" />

                <Label text="Storage Location:" GridPane.rowIndex="1" GridPane.columnIndex="2"
                       style="-fx-font-weight: bold;" />
                <TextField fx:id="storageField" promptText="Enter storage location"
                           prefWidth="250" GridPane.rowIndex="1" GridPane.columnIndex="3" />
            </GridPane>

            <!-- Action Buttons -->
            <HBox spacing="15" alignment="CENTER_RIGHT" style="-fx-padding: 15 0 0 0;">
                <Button text="Clear All" fx:id="clearBtn" onAction="#handleClearFields"
                        style="-fx-background-color: #95a5a6; -fx-text-fill: white;" />
                <Button text="Update Item" fx:id="updateBtn" onAction="#handleUpdateInventory"
                        style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-weight: bold;" />
            </HBox>
        </VBox>

        <!-- Status Bar -->
        <HBox spacing="10" alignment="CENTER_LEFT"
              style="-fx-padding: 10; -fx-background-color: #34495e; -fx-border-radius: 5;">
            <Label fx:id="statusLabel" text="Ready"
                   style="-fx-text-fill: white; -fx-font-size: 14px;" />
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="timeLabel" text=""
                   style="-fx-text-fill: #bdc3c7; -fx-font-size: 12px;" />
        </HBox>
    </VBox>

</AnchorPane>